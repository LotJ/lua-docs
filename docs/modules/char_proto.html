<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>LotJ Lua API</title>
    <link rel="stylesheet" href="../ldoc_new.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>LOTJ Lua API</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Class_CharProto">Class CharProto </a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/area.html">area</a></li>
  <li><strong>char_proto</strong></li>
  <li><a href="../modules/character.html">character</a></li>
  <li><a href="../modules/clan.html">clan</a></li>
  <li><a href="../modules/core.html">core</a></li>
  <li><a href="../modules/exit.html">exit</a></li>
  <li><a href="../modules/furniture.html">furniture</a></li>
  <li><a href="../modules/obj_proto.html">obj_proto</a></li>
  <li><a href="../modules/object.html">object</a></li>
  <li><a href="../modules/planet.html">planet</a></li>
  <li><a href="../modules/room.html">room</a></li>
  <li><a href="../modules/ship.html">ship</a></li>
  <li><a href="../modules/ship_template.html">ship_template</a></li>
  <li><a href="../modules/space_spawn.html">space_spawn</a></li>
  <li><a href="../modules/starsystem.html">starsystem</a></li>
  <li><a href="../modules/structure.html">structure</a></li>
  <li><a href="../modules/timer.html">timer</a></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="../topics/01-introduction.md.html">Introduction</a></li>
  <li><a href="../topics/02-lua-basics.md.html">Lua Basics</a></li>
  <li><a href="../topics/03-creating-an-lprog.md.html">Creating an lprog</a></li>
  <li><a href="../topics/04-before-after-lylek-drone.md.html">Before and After: Lylek Drone</a></li>
</ul>
<h2>Examples</h2>
<ul class="nowrap">
  <li><a href="../examples/mixrmastr-bartender-droid.lua.html">mixrmastr-bartender-droid.lua</a></li>
  <li><a href="../examples/yatta-invisible-market.lua.html">yatta-invisible-market.lua</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>char_proto</code></h1>
<p>Functions for mob prototypes, including triggers</p>
<p>

</p>


<h2><a href="#Class_CharProto">Class CharProto </a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#charproto:getDescription">charproto:getDescription ()</a></td>
	<td class="summary">Gets the description for the mob prototype.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:getName">charproto:getName ()</a></td>
	<td class="summary">Gets the name for the mob prototype.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onAct">charproto:onAct (message, callback)</a></td>
	<td class="summary">registers a function to run when the given action message is shown to the mob.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onBribe">charproto:onBribe (amount, callback)</a></td>
	<td class="summary">registers a function to run when the given number of credits is given to the character.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onDamage">charproto:onDamage (callback)</a></td>
	<td class="summary">registers a function to run each time the mob is damaged.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onDeath">charproto:onDeath (callback)</a></td>
	<td class="summary">registers a function to run when a mob is killed.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onEnter">charproto:onEnter (callback)</a></td>
	<td class="summary">registers a function to run whenever the mob itself enters a new room.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onFight">charproto:onFight (callback)</a></td>
	<td class="summary">registers a function to run during each combat round the mob is in.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onGive">charproto:onGive (callback)</a></td>
	<td class="summary">registers a function to run every time any object is given to this character.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onGreet">charproto:onGreet (callback)</a></td>
	<td class="summary">registers a function to run when another character enters the room.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onLook">charproto:onLook (callback)</a></td>
	<td class="summary">registers a function to run when a character looks at this one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onRandom">charproto:onRandom (chance, callback)</a></td>
	<td class="summary">registers a function with a chance to run every mob tick (10 seconds).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onSayto">charproto:onSayto (callback)</a></td>
	<td class="summary">registers a function to run when something is said to a mob using sayto</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onSpawned">charproto:onSpawned (callback)</a></td>
	<td class="summary">registers a function to run when a mob is spawned via reset.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onSpeech">charproto:onSpeech (message, callback)</a></td>
	<td class="summary">registers a function to run when the given text is spoken in the room.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:onTime">charproto:onTime (hour, callback)</a></td>
	<td class="summary">registers a function to run every time the hour changes to a certain value.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:setDescription">charproto:setDescription (desc)</a></td>
	<td class="summary">set the full description for a mob prototype.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#charproto:setName">charproto:setName (name)</a></td>
	<td class="summary">set the name for a mob prototype.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header has-description"><a name="Class_CharProto"></a>Class CharProto </h2>

          <div class="section-description">
          Functions on character prototype variables
          </div>
    <dl class="function">
    <dt>
    <a name = "charproto:getDescription"></a>
    <strong>charproto:getDescription ()</strong>
    </dt>
    <dd>
    Gets the description for the mob prototype.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">string</span></span>
        the description value
    </ol>




</dd>
    <dt>
    <a name = "charproto:getName"></a>
    <strong>charproto:getName ()</strong>
    </dt>
    <dd>
    Gets the name for the mob prototype.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><span class="type">string</span></span>
        the name value
    </ol>




</dd>
    <dt>
    <a name = "charproto:onAct"></a>
    <strong>charproto:onAct (message, callback)</strong>
    </dt>
    <dd>
    registers a function to run when the given action message is shown to the mob.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
            <span class="types"><span class="type">string</span></span>
         the message to trigger on
        </li>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> who did the action
 3. the full text of the action message
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onAct</span>(<span class="string">"begins drawing a bead on you!"</span>, <span class="keyword">function</span>(self, actor, fullText)
  actor:<span class="function-name">echoAt</span>(<span class="string">"You can't aim at me!"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onBribe"></a>
    <strong>charproto:onBribe (amount, callback)</strong>
    </dt>
    <dd>
    registers a function to run when the given number of credits is given to the character.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">amount</span>
            <span class="types"><span class="type">integer</span></span>
         the number of credits required to trigger the bribe, exact match only
        </li>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> who gave the credits
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onBribe</span>(<span class="number">10000</span>, <span class="keyword">function</span>(self, ch)
  self:<span class="function-name">sayTo</span>(ch, <span class="string">"Thank you for your patronage."</span>)
  self:<span class="function-name">awardCredits</span>(-<span class="number">10000</span>) <span class="comment">-- Clean up the credits
</span><span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onDamage"></a>
    <strong>charproto:onDamage (callback)</strong>
    </dt>
    <dd>
    registers a function to run each time the mob is damaged.
 This is called after the damage is applied.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> doing the damage (can be nil)
 3. the amount of damage done (integer)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onDamage</span>(<span class="keyword">function</span>(self, ch, amount)
  self:<span class="function-name">sayTo</span>(ch, <span class="string">"You hit me for "</span>..amount..<span class="string">" damage"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onDeath"></a>
    <strong>charproto:onDeath (callback)</strong>
    </dt>
    <dd>
    registers a function to run when a mob is killed.
 This is run while the mob technically still exists in the room where it died, so it can
 still interact with players and objects there.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. the <a href="../modules/character.html#Character">Character</a> being killed
 2. the <a href="../modules/character.html#Character">Character</a> who killed it (can be nil)
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onDeath</span>(<span class="keyword">function</span>(self, byChar)
  <span class="keyword">if</span> <span class="keyword">not</span> byChar <span class="keyword">then</span>
    <span class="keyword">return</span>
  <span class="keyword">end</span>
  byChar:<span class="function-name">echoAt</span>(<span class="string">"Good job, you killed "</span>..self:<span class="function-name">getShortDescription</span>()..<span class="string">"!"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onEnter"></a>
    <strong>charproto:onEnter (callback)</strong>
    </dt>
    <dd>
    registers a function to run whenever the mob itself enters a new room.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/room.html#Room">Room</a> it came from
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onEnter</span>(<span class="keyword">function</span>(self, oldRoom)
  <span class="comment">-- Do stuff
</span><span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onFight"></a>
    <strong>charproto:onFight (callback)</strong>
    </dt>
    <dd>
    registers a function to run during each combat round the mob is in.
 This runs every single round, so use math.rand in the function if you don't need it to happen every time.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> it's fighting
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onFight</span>(<span class="keyword">function</span>(self, target)
  target:<span class="function-name">echoAt</span>(<span class="string">"I'll win this fight yet!"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onGive"></a>
    <strong>charproto:onGive (callback)</strong>
    </dt>
    <dd>
    registers a function to run every time any object is given to this character.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/object.html#Object">Object</a> given to the character
 3. the <a href="../modules/character.html#Character">Character</a> who gave the object
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onGive</span>(<span class="keyword">function</span>(self, obj, ch)
  <span class="keyword">if</span> obj:<span class="function-name">getVNum</span>() == <span class="number">1000</span> <span class="keyword">then</span>
    self:<span class="function-name">sayTo</span>(ch, <span class="string">"Great, this is what I needed."</span>)
  <span class="keyword">else</span>
    self:<span class="function-name">sayTo</span>(ch, <span class="string">"Huh? I don't want that."</span>)
    self:<span class="function-name">emote</span>(<span class="string">"returns "</span>..obj:<span class="function-name">getShortDescription</span>()..<span class="string">"."</span>)
    obj:<span class="function-name">toChar</span>(ch)
  <span class="keyword">end</span>
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onGreet"></a>
    <strong>charproto:onGreet (callback)</strong>
    </dt>
    <dd>
    registers a function to run when another character enters the room.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> who entered
 3. the <a href="../modules/room.html#Room">Room</a> they came from
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onGreet</span>(<span class="keyword">function</span>(self, target, fromRoom)
  target:<span class="function-name">echoAt</span>(<span class="string">"You notice "</span>..self:<span class="function-name">getShortDescription</span>()..<span class="string">" waving at you."</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onLook"></a>
    <strong>charproto:onLook (callback)</strong>
    </dt>
    <dd>
    registers a function to run when a character looks at this one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> who looked at this one
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onLook</span>(<span class="keyword">function</span>(self, ch)
  self:<span class="function-name">sayTo</span>(ch, <span class="string">"What are you looking at?"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onRandom"></a>
    <strong>charproto:onRandom (chance, callback)</strong>
    </dt>
    <dd>
    registers a function with a chance to run every mob tick (10 seconds).


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">chance</span>
            <span class="types"><span class="type">integer</span></span>
         the chance, 1-100, that the trigger will fire on a given tick
        </li>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onRandom</span>(<span class="number">25</span>, <span class="keyword">function</span>(self)
  <span class="comment">-- Do stuff
</span><span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onSayto"></a>
    <strong>charproto:onSayto (callback)</strong>
    </dt>
    <dd>
    registers a function to run when something is said to a mob using sayto


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. the <a href="../modules/character.html#Character">Character</a> being said to
 2. the <a href="../modules/character.html#Character">Character</a> doing the speaking
 2. a string of what was said
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onSayto</span>(<span class="keyword">function</span>(self, speaker, text)
  self:<span class="function-name">force</span>(<span class="string">"say You said "</span>..text..<span class="string">" to me!"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onSpawned"></a>
    <strong>charproto:onSpawned (callback)</strong>
    </dt>
    <dd>
    registers a function to run when a mob is spawned via reset.
 Does not apply when it is invoked manually or via progs.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onSpawned</span>(<span class="keyword">function</span>(self)
  Object.<span class="function-name">invoke</span>(<span class="number">170050</span>):<span class="function-name">toChar</span>(self)
  self:<span class="function-name">force</span>(<span class="string">"wield sword"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onSpeech"></a>
    <strong>charproto:onSpeech (message, callback)</strong>
    </dt>
    <dd>
    registers a function to run when the given text is spoken in the room.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">message</span>
            <span class="types"><span class="type">string</span></span>
         the message to trigger on
        </li>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
 2. the <a href="../modules/character.html#Character">Character</a> who spoke
 3. the full text spoken
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onSpeech</span>(<span class="string">"assistance"</span>, <span class="keyword">function</span>(self, speaker, fullText)
  speaker:<span class="function-name">echoAt</span>(<span class="string">"Yeah, sure, I need some help with the womp rats in the warehouse."</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:onTime"></a>
    <strong>charproto:onTime (hour, callback)</strong>
    </dt>
    <dd>
    registers a function to run every time the hour changes to a certain value.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">hour</span>
            <span class="types"><span class="type">integer</span></span>
         the hour of day to trigger at, 0-23
        </li>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">func</span></span>
         the function to run, taking arguments:
 1. this <a href="../modules/character.html#Character">Character</a>
        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">self:<span class="function-name">onTime</span>(<span class="number">6</span>, <span class="keyword">function</span>(self)
  self:<span class="function-name">say</span>(<span class="string">"Good morning!"</span>)
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "charproto:setDescription"></a>
    <strong>charproto:setDescription (desc)</strong>
    </dt>
    <dd>
    set the full description for a mob prototype.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">desc</span>
            <span class="types"><span class="type">string</span></span>
         the new description
        </li>
    </ul>





</dd>
    <dt>
    <a name = "charproto:setName"></a>
    <strong>charproto:setName (name)</strong>
    </dt>
    <dd>
    set the name for a mob prototype.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="types"><span class="type">string</span></span>
         the new name
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/lunarmodules/ldoc">LDoc 1.5.0</a></i>
<i style="float:right;">Last updated 2023-07-17 22:47:01 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
